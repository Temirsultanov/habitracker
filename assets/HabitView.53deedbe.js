import{_ as u,o as r,c as h,a as i,r as c,t as g,b as _,M as f,d as M,m as D,R as w,F as b,e as T,n as $,f as L,A as I,g as F,h as B,i as N,j as H,w as O,k as p,l as Y}from"./index.d63edea8.js";const q={},P={class:"pencilIcon",width:"18",height:"18",viewBox:"0 0 18 18",fill:"none",xmlns:"http://www.w3.org/2000/svg"},A=i("path",{d:"M1.11839 14.7236L2.48711 11.3879L12.4356 4.67758L14.9227 3L17.1594 6.31615L14.6723 7.99373L4.72388 14.704L1.11839 14.7236Z",fill:"#F8F8F8"},null,-1),E=i("path",{d:"M4.43454 12.4868L13.5539 6.33566M13.5539 6.33566L12.4356 4.67758M13.5539 6.33566L14.6723 7.99373M12.4356 4.67758L2.48711 11.3879L1.11839 14.7236L4.72388 14.704L14.6723 7.99373M12.4356 4.67758L14.9227 3L17.1594 6.31615L14.6723 7.99373",stroke:"#262626","stroke-linecap":"round","stroke-linejoin":"round"},null,-1),V=[A,E];function S(e,s){return r(),h("svg",P,V)}const j=u(q,[["render",S]]);const R={components:{PencilIcon:j},emits:{"open-changing-modal":null},props:{habit:{type:Object,required:!0}},computed:{countSuccessedDays(){const e=[...this.habit.days].reverse(),s=e.findIndex(a=>a.is_done===!1);let o=0;return s===-1?o+e.length:o+s},formattedBeginDay(){return new Intl.DateTimeFormat("ru",{day:"2-digit",month:"2-digit",year:"2-digit"}).format(this.habit.begin_day)}},methods:{openChangingModal(){this.$emit("open-changing-modal")}}},U={class:"habitInfo"},W={class:"habitInfo__top"},z={class:"title"},Z={class:"habitInfo__bottom"},G={class:"text-small"},J={class:"text-small"};function K(e,s,o,a,n,t){const l=c("pencil-icon");return r(),h("div",U,[i("div",W,[i("h3",z,g(o.habit.title),1),i("button",{onClick:s[0]||(s[0]=(...d)=>t.openChangingModal&&t.openChangingModal(...d)),class:"habitInfo__changeButton"},[_(l)])]),i("div",Z,[i("span",G,"\u0414\u043D\u0435\u0439 \u043F\u043E\u0434\u0440\u044F\u0434: "+g(t.countSuccessedDays),1),i("span",J," \u041D\u0430\u0447\u0430\u043B\u043E: "+g(t.formattedBeginDay),1)])])}const Q=u(R,[["render",K]]),X={components:{ModalTemplate:f},props:{habitTitle:{type:String,required:!0}},emits:{close:null,"change-title":null},data(){return{attrs:{inputValue:this.habitTitle,buttonText:"\u0421\u043E\u0445\u0440\u0430\u043D\u0438\u0442\u044C",buttonType:"success"}}},methods:{close(){this.$emit("close")},onButtonClick(e){e!==""&&(this.$emit("change-title",e),this.close())}}};function tt(e,s,o,a,n,t){const l=c("modal-template");return r(),M(l,D(n.attrs,{onClose:t.close,onButtonClick:t.onButtonClick}),null,16,["onClose","onButtonClick"])}const et=u(X,[["render",tt]]),nt={components:{ModalTemplate:f},props:{habitTitle:{type:String,required:!0}},emits:{close:null,"delete-habit":null},data(){return{attrs:{title:`\u0412\u044B \u0443\u0432\u0435\u0440\u0435\u043D\u044B, \u0447\u0442\u043E \u0445\u043E\u0442\u0438\u0442\u0435  \u0443\u0434\u0430\u043B\u0438\u0442\u044C \u043F\u0440\u0438\u0432\u044B\u0447\u043A\u0443 \xAB${this.habitTitle}\xBB?`,buttonText:"\u0423\u0434\u0430\u043B\u0438\u0442\u044C",buttonType:"danger"}}},methods:{close(){this.$emit("close")},onButtonClick(){this.$emit("delete-habit"),this.close()}}};function st(e,s,o,a,n,t){const l=c("modal-template");return r(),M(l,D(n.attrs,{onClose:t.close,onButtonClick:t.onButtonClick}),null,16,["onClose","onButtonClick"])}const ot=u(nt,[["render",st]]);const at={},it={class:"leftArrowIcon",width:"9",height:"14",viewBox:"0 0 9 14",fill:"none",xmlns:"http://www.w3.org/2000/svg"},lt=i("path",{d:"M8 1L1 7L8 13",stroke:"black","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"},null,-1),rt=[lt];function ct(e,s){return r(),h("svg",it,rt)}const ht=u(at,[["render",ct]]);const dt=new Intl.DateTimeFormat("ru",{month:"long"}),_t={components:{LeftArrowIcon:ht,RightArrowIcon:w},props:{currentMonthDate:{type:Date,required:!0},isFirstMonth:{type:Boolean,required:!0},isLastMonth:{type:Boolean,required:!0}},emits:{"move-to-prev-month":null,"move-to-next-month":null},computed:{formattedDate(){const e=this.currentMonthDate.getFullYear(),s=dt.format(this.currentMonthDate);return`${s[0].toUpperCase()+s.slice(1)}, ${e}`}},methods:{moveToPrevMonth(){this.$emit("move-to-prev-month")},moveToNextMonth(){this.$emit("move-to-next-month")}}},ut={class:"calendarInfo"},mt={class:"text-medium"},gt={class:"calendarInfo__controls"},Mt=["disabled"],pt=["disabled"];function yt(e,s,o,a,n,t){const l=c("left-arrow-icon"),d=c("right-arrow-icon");return r(),h("div",ut,[i("h3",mt,g(t.formattedDate),1),i("div",gt,[i("button",{onClick:s[0]||(s[0]=(...m)=>t.moveToPrevMonth&&t.moveToPrevMonth(...m)),disabled:o.isFirstMonth,class:"calendarInfo__button","aria-label":"Move to Previous Month"},[_(l)],8,Mt),i("button",{onClick:s[1]||(s[1]=(...m)=>t.moveToNextMonth&&t.moveToNextMonth(...m)),disabled:o.isLastMonth,class:"calendarInfo__button","aria-label":"Move to Next Month"},[_(d)],8,pt)])])}const ft=u(_t,[["render",yt]]);const Dt={props:{days:{type:Array,required:!0}},methods:{getDayClass(e){if(e===!0)return"calendarDays__item-success";if(e===!1)return"calendarDays__item-failure"}}},bt={class:"calendarDays"},vt={class:"text-small"};function xt(e,s,o,a,n,t){return r(),h("ul",bt,[(r(!0),h(b,null,T(o.days,(l,d)=>(r(),h("li",{key:d,class:$([t.getDayClass(l.is_done),"calendarDays__item"])},[i("span",vt,g(l.number),1)],2))),128))])}const Ct=u(Dt,[["render",xt]]);const y=42,kt={components:{CalendarInfo:ft,CalendarDays:Ct},props:{days:{type:Array,required:!0}},data(){const e=this.days?this.days[this.days.length-1].date:new Date;return{currentMonthDate:new Date(e.getFullYear(),e.getMonth(),1)}},computed:{beginDay(){return this.days[0]},lastDay(){return this.days[this.days.length-1]},isFirstMonth(){const e=this.currentMonthDate.getMonth(),s=this.currentMonthDate.getFullYear(),o=e===this.beginDay.date.getMonth(),a=s===this.beginDay.date.getFullYear();return o&&a},isLastMonth(){const e=this.currentMonthDate.getMonth(),s=this.currentMonthDate.getFullYear(),o=e===this.lastDay.date.getMonth(),a=s===this.lastDay.date.getFullYear();return o&&a},daysList(){const e=[],s=(6+this.currentMonthDate.getDay())%7;e[s]={number:1};const o=this.currentMonthDate.getFullYear(),a=this.currentMonthDate.getMonth(),n=new Date(o,a,1);for(let t=s+1;t<y;t++)n.setDate(n.getDate()+1),e[t]={number:n.getDate()};n.setDate(1),n.setMonth(n.getMonth()-1);for(let t=s-1;t>-1;t--)n.setDate(n.getDate()-1),e[t]={number:n.getDate()};return this.fillList(e)}},methods:{moveToPrevMonth(){const e=this.currentMonthDate.getMonth()-1;this.currentMonthDate.setMonth(e),this.currentMonthDate=new Date(this.currentMonthDate)},moveToNextMonth(){const e=this.currentMonthDate.getMonth()+1;this.currentMonthDate.setMonth(e),this.currentMonthDate=new Date(this.currentMonthDate)},fillList(e){const s=(6+this.currentMonthDate.getDay())%7;let o;if(this.isLastMonth){const a=this.lastDay.date.getDate();o=this.days.length-1;for(let n=s+a-1;n>=0;n--)this.days[o]&&(e[n].is_done=this.days[o].is_done,o=o-1)}else if(this.isFirstMonth){const a=this.beginDay.date.getDate();o=0;for(let n=s+a-1;n<y;n++)this.days[o]&&(e[n].is_done=this.days[o].is_done),o=o+1}else{o=this.days.findIndex(t=>{const l=t.date.getMonth()===this.currentMonthDate.getMonth(),d=t.date.getFullYear()===this.currentMonthDate.getFullYear();return l&&d&&t.date.getDate()===1});let a=o;for(let t=s;t<y;t++)this.days[a]&&(e[t].is_done=this.days[a].is_done),a=a+1;let n=o;for(let t=s-1;t>=0;t--)e[t].is_done=this.days[n].is_done,n=n-1}return e}}},wt={class:"calendar"},Tt=L('<hr class="calendar__line"><ul class="calendar__weekNames"><li class="calendar__weekName text-small">\u043F\u043D</li><li class="calendar__weekName text-small">\u0432\u0442</li><li class="calendar__weekName text-small">\u0441\u0440</li><li class="calendar__weekName text-small">\u0447\u0442</li><li class="calendar__weekName text-small">\u043F\u0442</li><li class="calendar__weekName text-small">\u0441\u0431</li><li class="calendar__weekName text-small">\u0432\u0441</li></ul>',2);function $t(e,s,o,a,n,t){const l=c("calendar-info"),d=c("calendar-days");return r(),h("div",wt,[_(l,{onMoveToPrevMonth:t.moveToPrevMonth,onMoveToNextMonth:t.moveToNextMonth,currentMonthDate:n.currentMonthDate,isFirstMonth:t.isFirstMonth,isLastMonth:t.isLastMonth},null,8,["onMoveToPrevMonth","onMoveToNextMonth","currentMonthDate","isFirstMonth","isLastMonth"]),Tt,_(d,{days:t.daysList},null,8,["days"])])}const Lt=u(kt,[["render",$t]]);const It={components:{AppHeader:I,HabitInfo:Q,ChangingModal:et,DeletingModal:ot,HabitCalendar:Lt},data(){return{habit:null,isChangingModalOpened:!1,isDeletingModalOpened:!1}},methods:{openChangingModal(){this.isChangingModalOpened=!0},closeChangingModal(){this.isChangingModalOpened=!1},changeHabitTitle(e){F(this.habit.id,e)},openDeletingModal(){this.isDeletingModalOpened=!0},closeDeletingModal(){this.isDeletingModalOpened=!1},deleteHabit(){B(this.habit.id),this.$router.push("/")}},created(){N().then(e=>{if(!e)this.$router.push("/signup");else{const o=+this.$route.params.id;return H(o)}}).then(e=>this.habit=e)}},Ft={key:0,class:"habit"},Bt={class:"habit__deleteButtonWrapper"},Nt={key:1,class:"message text-small"},Ht={key:2,class:"message"},Ot=i("h3",{class:"title"},"\u041F\u0440\u0438\u0432\u044B\u0447\u043A\u0430 \u043D\u0435 \u043D\u0430\u0439\u0434\u0435\u043D\u0430 :(",-1),Yt=Y(" \u041F\u0435\u0440\u0435\u0439\u0442\u0438 \u043D\u0430 \u0433\u043B\u0430\u0432\u043D\u0443\u044E ");function qt(e,s,o,a,n,t){const l=c("app-header"),d=c("habit-info"),m=c("habit-calendar"),v=c("router-link"),x=c("changing-modal"),C=c("deleting-modal");return r(),h(b,null,[_(l),n.habit?(r(),h("section",Ft,[_(d,{onOpenChangingModal:t.openChangingModal,habit:n.habit},null,8,["onOpenChangingModal","habit"]),_(m,{days:n.habit.days},null,8,["days"]),i("div",Bt,[i("button",{onClick:s[0]||(s[0]=(...k)=>t.openDeletingModal&&t.openDeletingModal(...k)),class:"habit__deleteButton text-small"}," \u0423\u0434\u0430\u043B\u0438\u0442\u044C \u043F\u0440\u0438\u0432\u044B\u0447\u043A\u0443 ")])])):n.habit===null?(r(),h("h3",Nt," \u041F\u0440\u0438\u0432\u044B\u0447\u043A\u0430 \u0433\u0440\u0443\u0437\u0438\u0442\u0441\u044F, \u043F\u043E\u0434\u043E\u0436\u0434\u0438\u0442\u0435 \u0441\u0435\u043A\u0443\u043D\u0434\u0443... ")):n.habit===void 0?(r(),h("div",Ht,[Ot,_(v,{to:"/",class:"habit__linkToHome text-small"},{default:O(()=>[Yt]),_:1})])):p("",!0),n.isChangingModalOpened?(r(),M(x,{key:3,onClose:t.closeChangingModal,onChangeTitle:t.changeHabitTitle,habitTitle:n.habit.title},null,8,["onClose","onChangeTitle","habitTitle"])):p("",!0),n.isDeletingModalOpened?(r(),M(C,{key:4,onClose:t.closeDeletingModal,onDeleteHabit:t.deleteHabit,habitTitle:n.habit.title},null,8,["onClose","onDeleteHabit","habitTitle"])):p("",!0)],64)}const At=u(It,[["render",qt]]);export{At as default};
