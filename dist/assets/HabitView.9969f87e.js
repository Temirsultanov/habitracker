import{_,o as r,c as h,a as i,r as c,t as g,b as u,M as f,d as M,m as D,R as k,F as b,e as w,n as $,f as N,g as L,h as I,i as F,w as T,j as p,k as B}from"./index.6664ceb5.js";const H={},O={class:"pencilIcon",width:"18",height:"18",viewBox:"0 0 18 18",fill:"none",xmlns:"http://www.w3.org/2000/svg"},Y=i("path",{d:"M1.11839 14.7236L2.48711 11.3879L12.4356 4.67758L14.9227 3L17.1594 6.31615L14.6723 7.99373L4.72388 14.704L1.11839 14.7236Z",fill:"#F8F8F8"},null,-1),q=i("path",{d:"M4.43454 12.4868L13.5539 6.33566M13.5539 6.33566L12.4356 4.67758M13.5539 6.33566L14.6723 7.99373M12.4356 4.67758L2.48711 11.3879L1.11839 14.7236L4.72388 14.704L14.6723 7.99373M12.4356 4.67758L14.9227 3L17.1594 6.31615L14.6723 7.99373",stroke:"#262626","stroke-linecap":"round","stroke-linejoin":"round"},null,-1),P=[Y,q];function A(e,n){return r(),h("svg",O,P)}const E=_(H,[["render",A]]);const V={components:{PencilIcon:E},emits:{"open-changing-modal":null},props:{habit:{type:Object,required:!0}},computed:{countSuccessedDays(){const e=[...this.habit.days].reverse(),n=e.findIndex(s=>s.state===!1);let a=0;return e[0].state===!0&&(a=a+1),n===-1?a+e.length-1:a+n-1},formattedBeginDay(){return new Intl.DateTimeFormat("ru",{day:"2-digit",month:"2-digit",year:"2-digit"}).format(this.habit.beginDay)}},methods:{openChangingModal(){this.$emit("open-changing-modal")}}},S={class:"habitInfo"},j={class:"habitInfo__top"},R={class:"title"},U={class:"habitInfo__bottom"},W={class:"text-small"},z={class:"text-small"};function Z(e,n,a,o,s,t){const l=c("pencil-icon");return r(),h("div",S,[i("div",j,[i("h3",R,g(a.habit.name),1),i("button",{onClick:n[0]||(n[0]=(...d)=>t.openChangingModal&&t.openChangingModal(...d)),class:"habitInfo__changeButton"},[u(l)])]),i("div",U,[i("span",W,"\u0414\u043D\u0435\u0439 \u043F\u043E\u0434\u0440\u044F\u0434: "+g(t.countSuccessedDays),1),i("span",z," \u041D\u0430\u0447\u0430\u043B\u043E: "+g(t.formattedBeginDay),1)])])}const G=_(V,[["render",Z]]),J={components:{ModalTemplate:f},props:{habitName:{type:String,required:!0}},emits:{close:null,"change-name":null},data(){return{attrs:{inputValue:this.habitName,buttonText:"\u0421\u043E\u0445\u0440\u0430\u043D\u0438\u0442\u044C",buttonType:"success"}}},methods:{close(){this.$emit("close")},onButtonClick(e){e!==""&&(this.$emit("change-name",e),this.close())}}};function K(e,n,a,o,s,t){const l=c("modal-template");return r(),M(l,D(s.attrs,{onClose:t.close,onButtonClick:t.onButtonClick}),null,16,["onClose","onButtonClick"])}const Q=_(J,[["render",K]]),X={components:{ModalTemplate:f},props:{habitName:{type:String,required:!0}},emits:{close:null,deleteHabit:null},data(){return{attrs:{title:`\u0412\u044B \u0443\u0432\u0435\u0440\u0435\u043D\u044B, \u0447\u0442\u043E \u0445\u043E\u0442\u0438\u0442\u0435  \u0443\u0434\u0430\u043B\u0438\u0442\u044C \u043F\u0440\u0438\u0432\u044B\u0447\u043A\u0443 \xAB${this.habitName}\xBB?`,buttonText:"\u0423\u0434\u0430\u043B\u0438\u0442\u044C",buttonType:"danger"}}},methods:{close(){this.$emit("close")},onButtonClick(){this.$emit("delete-habit"),this.close()}}};function tt(e,n,a,o,s,t){const l=c("modal-template");return r(),M(l,D(s.attrs,{onClose:t.close,onButtonClick:t.onButtonClick}),null,16,["onClose","onButtonClick"])}const et=_(X,[["render",tt]]);const nt={},st={class:"leftArrowIcon",width:"9",height:"14",viewBox:"0 0 9 14",fill:"none",xmlns:"http://www.w3.org/2000/svg"},at=i("path",{d:"M8 1L1 7L8 13",stroke:"black","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"},null,-1),ot=[at];function it(e,n){return r(),h("svg",st,ot)}const lt=_(nt,[["render",it]]);const rt=new Intl.DateTimeFormat("ru",{month:"long"}),ct={components:{LeftArrowIcon:lt,RightArrowIcon:k},props:{currentMonthDate:{type:Date,required:!0},isFirstMonth:{type:Boolean,required:!0},isLastMonth:{type:Boolean,required:!0}},emits:{"move-to-prev-month":null,"move-to-next-month":null},computed:{formattedDate(){const e=this.currentMonthDate.getFullYear(),n=rt.format(this.currentMonthDate);return`${n[0].toUpperCase()+n.slice(1)}, ${e}`}},methods:{moveToPrevMonth(){this.$emit("move-to-prev-month")},moveToNextMonth(){this.$emit("move-to-next-month")}}},ht={class:"calendarInfo"},dt={class:"text-medium"},_t={class:"calendarInfo__controls"},ut=["disabled"],mt=["disabled"];function gt(e,n,a,o,s,t){const l=c("left-arrow-icon"),d=c("right-arrow-icon");return r(),h("div",ht,[i("h3",dt,g(t.formattedDate),1),i("div",_t,[i("button",{onClick:n[0]||(n[0]=(...m)=>t.moveToPrevMonth&&t.moveToPrevMonth(...m)),disabled:a.isFirstMonth,class:"calendarInfo__button","aria-label":"Move to Previous Month"},[u(l)],8,ut),i("button",{onClick:n[1]||(n[1]=(...m)=>t.moveToNextMonth&&t.moveToNextMonth(...m)),disabled:a.isLastMonth,class:"calendarInfo__button","aria-label":"Move to Next Month"},[u(d)],8,mt)])])}const Mt=_(ct,[["render",gt]]);const pt={props:{days:{type:Array,required:!0}},methods:{getDayClass(e){let n;return e===!0?n="calendarDays__item-success":e===!1?n="calendarDays__item-failure":e===null&&(n="calendarDays__item-current"),n}}},yt={class:"calendarDays"},ft={class:"text-small"};function Dt(e,n,a,o,s,t){return r(),h("ul",yt,[(r(!0),h(b,null,w(a.days,(l,d)=>(r(),h("li",{key:d,class:$([t.getDayClass(l.state),"calendarDays__item"])},[i("span",ft,g(l.number),1)],2))),128))])}const bt=_(pt,[["render",Dt]]);const y=42,vt={components:{CalendarInfo:Mt,CalendarDays:bt},props:{days:{type:Array,required:!0}},data(){const e=this.days[this.days.length-1].date;return{currentMonthDate:new Date(e.getFullYear(),e.getMonth(),1)}},computed:{beginDay(){return this.days[0]},lastDay(){return this.days[this.days.length-1]},isFirstMonth(){const e=this.currentMonthDate.getMonth(),n=this.currentMonthDate.getFullYear(),a=e===this.beginDay.date.getMonth(),o=n===this.beginDay.date.getFullYear();return a&&o},isLastMonth(){const e=this.currentMonthDate.getMonth(),n=this.currentMonthDate.getFullYear(),a=e===this.lastDay.date.getMonth(),o=n===this.lastDay.date.getFullYear();return a&&o},daysList(){const e=[],n=(6+this.currentMonthDate.getDay())%7;e[n]={number:1};const a=this.currentMonthDate.getFullYear(),o=this.currentMonthDate.getMonth(),s=new Date(a,o,1);for(let t=n+1;t<y;t++)s.setDate(s.getDate()+1),e[t]={number:s.getDate()};s.setDate(1),s.setMonth(s.getMonth()-1);for(let t=n-1;t>-1;t--)s.setDate(s.getDate()-1),e[t]={number:s.getDate()};return this.fillList(e)}},methods:{moveToPrevMonth(){const e=this.currentMonthDate.getMonth()-1;this.currentMonthDate.setMonth(e),this.currentMonthDate=new Date(this.currentMonthDate)},moveToNextMonth(){const e=this.currentMonthDate.getMonth()+1;this.currentMonthDate.setMonth(e),this.currentMonthDate=new Date(this.currentMonthDate)},fillList(e){const n=(6+this.currentMonthDate.getDay())%7;let a;if(this.isLastMonth){const o=this.lastDay.date.getDate();a=this.days.length-1;for(let s=n+o-1;s>=0;s--)this.days[a]&&(e[s].state=this.days[a].state,a=a-1)}else if(this.isFirstMonth){const o=this.beginDay.date.getDate();a=0;for(let s=n+o-1;s<y;s++)this.days[a]&&(e[s].state=this.days[a].state),a=a+1}else{a=this.days.findIndex(t=>{const l=t.date.getMonth()===this.currentMonthDate.getMonth(),d=t.date.getFullYear()===this.currentMonthDate.getFullYear();return l&&d&&t.date.getDate()===1});let o=a;for(let t=n;t<y;t++)this.days[o]&&(e[t].state=this.days[o].state),o=o+1;let s=a;for(let t=n-1;t>=0;t--)e[t].state=this.days[s].state,s=s-1}return e}}},xt={class:"calendar"},Ct=N('<hr class="calendar__line"><ul class="calendar__weekNames"><li class="calendar__weekName text-small">\u043F\u043D</li><li class="calendar__weekName text-small">\u0432\u0442</li><li class="calendar__weekName text-small">\u0441\u0440</li><li class="calendar__weekName text-small">\u0447\u0442</li><li class="calendar__weekName text-small">\u043F\u0442</li><li class="calendar__weekName text-small">\u0441\u0431</li><li class="calendar__weekName text-small">\u0432\u0441</li></ul>',2);function kt(e,n,a,o,s,t){const l=c("calendar-info"),d=c("calendar-days");return r(),h("div",xt,[u(l,{onMoveToPrevMonth:t.moveToPrevMonth,onMoveToNextMonth:t.moveToNextMonth,currentMonthDate:s.currentMonthDate,isFirstMonth:t.isFirstMonth,isLastMonth:t.isLastMonth},null,8,["onMoveToPrevMonth","onMoveToNextMonth","currentMonthDate","isFirstMonth","isLastMonth"]),Ct,u(d,{days:t.daysList},null,8,["days"])])}const wt=_(vt,[["render",kt]]);const $t={components:{HabitInfo:G,ChangingModal:Q,DeletingModal:et,HabitCalendar:wt},data(){return{habit:null,isChangingModalOpened:!1,isDeletingModalOpened:!1}},methods:{openChangingModal(){this.isChangingModalOpened=!0},closeChangingModal(){this.isChangingModalOpened=!1},changeHabitName(e){L(this.habit.id,e)},openDeletingModal(){this.isDeletingModalOpened=!0},closeDeletingModal(){this.isDeletingModalOpened=!1},deleteHabit(){I(this.habit.id),this.$router.push("/")}},created(){const n=+this.$route.params.id;F(n).then(a=>this.habit=a)}},Nt={key:0,class:"habit"},Lt={class:"habit__deleteButtonWrapper"},It={key:1,class:"message text-small"},Ft={key:2,class:"message"},Tt=i("h3",{class:"title"},"\u041F\u0440\u0438\u0432\u044B\u0447\u043A\u0430 \u043D\u0435 \u043D\u0430\u0439\u0434\u0435\u043D\u0430 :(",-1),Bt=B(" \u041F\u0435\u0440\u0435\u0439\u0442\u0438 \u043D\u0430 \u0433\u043B\u0430\u0432\u043D\u0443\u044E ");function Ht(e,n,a,o,s,t){const l=c("habit-info"),d=c("habit-calendar"),m=c("router-link"),v=c("changing-modal"),x=c("deleting-modal");return r(),h(b,null,[s.habit?(r(),h("section",Nt,[u(l,{onOpenChangingModal:t.openChangingModal,habit:s.habit},null,8,["onOpenChangingModal","habit"]),u(d,{days:s.habit.days},null,8,["days"]),i("div",Lt,[i("button",{onClick:n[0]||(n[0]=(...C)=>t.openDeletingModal&&t.openDeletingModal(...C)),class:"habit__deleteButton text-small"}," \u0423\u0434\u0430\u043B\u0438\u0442\u044C \u043F\u0440\u0438\u0432\u044B\u0447\u043A\u0443 ")])])):s.habit===null?(r(),h("h3",It," \u041F\u0440\u0438\u0432\u044B\u0447\u043A\u0430 \u0433\u0440\u0443\u0437\u0438\u0442\u0441\u044F, \u043F\u043E\u0434\u043E\u0436\u0434\u0438\u0442\u0435 \u0441\u0435\u043A\u0443\u043D\u0434\u0443... ")):s.habit===void 0?(r(),h("div",Ft,[Tt,u(m,{to:"/",class:"habit__linkToHome text-small"},{default:T(()=>[Bt]),_:1})])):p("",!0),s.isChangingModalOpened?(r(),M(v,{key:3,onClose:t.closeChangingModal,onChangeName:t.changeHabitName,habitName:s.habit.name},null,8,["onClose","onChangeName","habitName"])):p("",!0),s.isDeletingModalOpened?(r(),M(x,{key:4,onClose:t.closeDeletingModal,onDeleteHabit:t.deleteHabit,habitName:s.habit.name},null,8,["onClose","onDeleteHabit","habitName"])):p("",!0)],64)}const Yt=_($t,[["render",Ht]]);export{Yt as default};
