import{_ as u,o as r,c as h,a as i,r as c,t as g,b as _,M as f,d as M,m as D,R as w,F as b,e as T,n as $,f as L,A as I,g as F,h as B,i as N,w as H,j as p,k as O}from"./index.678815f7.js";const Y={},q={class:"pencilIcon",width:"18",height:"18",viewBox:"0 0 18 18",fill:"none",xmlns:"http://www.w3.org/2000/svg"},P=i("path",{d:"M1.11839 14.7236L2.48711 11.3879L12.4356 4.67758L14.9227 3L17.1594 6.31615L14.6723 7.99373L4.72388 14.704L1.11839 14.7236Z",fill:"#F8F8F8"},null,-1),A=i("path",{d:"M4.43454 12.4868L13.5539 6.33566M13.5539 6.33566L12.4356 4.67758M13.5539 6.33566L14.6723 7.99373M12.4356 4.67758L2.48711 11.3879L1.11839 14.7236L4.72388 14.704L14.6723 7.99373M12.4356 4.67758L14.9227 3L17.1594 6.31615L14.6723 7.99373",stroke:"#262626","stroke-linecap":"round","stroke-linejoin":"round"},null,-1),E=[P,A];function V(e,s){return r(),h("svg",q,E)}const S=u(Y,[["render",V]]);const j={components:{PencilIcon:S},emits:{"open-changing-modal":null},props:{habit:{type:Object,required:!0}},computed:{countSuccessedDays(){const e=[...this.habit.days].reverse(),s=e.findIndex(a=>a.is_done===!1);let o=0;return s===-1?o+e.length:o+s},formattedBeginDay(){return new Intl.DateTimeFormat("ru",{day:"2-digit",month:"2-digit",year:"2-digit"}).format(this.habit.beginDay)}},methods:{openChangingModal(){this.$emit("open-changing-modal")}}},R={class:"habitInfo"},U={class:"habitInfo__top"},W={class:"title"},z={class:"habitInfo__bottom"},Z={class:"text-small"},G={class:"text-small"};function J(e,s,o,a,n,t){const l=c("pencil-icon");return r(),h("div",R,[i("div",U,[i("h3",W,g(o.habit.title),1),i("button",{onClick:s[0]||(s[0]=(...d)=>t.openChangingModal&&t.openChangingModal(...d)),class:"habitInfo__changeButton"},[_(l)])]),i("div",z,[i("span",Z,"\u0414\u043D\u0435\u0439 \u043F\u043E\u0434\u0440\u044F\u0434: "+g(t.countSuccessedDays),1),i("span",G," \u041D\u0430\u0447\u0430\u043B\u043E: "+g(t.formattedBeginDay),1)])])}const K=u(j,[["render",J]]),Q={components:{ModalTemplate:f},props:{habitTitle:{type:String,required:!0}},emits:{close:null,"change-title":null},data(){return{attrs:{inputValue:this.habitTitle,buttonText:"\u0421\u043E\u0445\u0440\u0430\u043D\u0438\u0442\u044C",buttonType:"success"}}},methods:{close(){this.$emit("close")},onButtonClick(e){e!==""&&(this.$emit("change-title",e),this.close())}}};function X(e,s,o,a,n,t){const l=c("modal-template");return r(),M(l,D(n.attrs,{onClose:t.close,onButtonClick:t.onButtonClick}),null,16,["onClose","onButtonClick"])}const tt=u(Q,[["render",X]]),et={components:{ModalTemplate:f},props:{habitTitle:{type:String,required:!0}},emits:{close:null,"delete-habit":null},data(){return{attrs:{title:`\u0412\u044B \u0443\u0432\u0435\u0440\u0435\u043D\u044B, \u0447\u0442\u043E \u0445\u043E\u0442\u0438\u0442\u0435  \u0443\u0434\u0430\u043B\u0438\u0442\u044C \u043F\u0440\u0438\u0432\u044B\u0447\u043A\u0443 \xAB${this.habitTitle}\xBB?`,buttonText:"\u0423\u0434\u0430\u043B\u0438\u0442\u044C",buttonType:"danger"}}},methods:{close(){this.$emit("close")},onButtonClick(){this.$emit("delete-habit"),this.close()}}};function nt(e,s,o,a,n,t){const l=c("modal-template");return r(),M(l,D(n.attrs,{onClose:t.close,onButtonClick:t.onButtonClick}),null,16,["onClose","onButtonClick"])}const st=u(et,[["render",nt]]);const ot={},at={class:"leftArrowIcon",width:"9",height:"14",viewBox:"0 0 9 14",fill:"none",xmlns:"http://www.w3.org/2000/svg"},it=i("path",{d:"M8 1L1 7L8 13",stroke:"black","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"},null,-1),lt=[it];function rt(e,s){return r(),h("svg",at,lt)}const ct=u(ot,[["render",rt]]);const ht=new Intl.DateTimeFormat("ru",{month:"long"}),dt={components:{LeftArrowIcon:ct,RightArrowIcon:w},props:{currentMonthDate:{type:Date,required:!0},isFirstMonth:{type:Boolean,required:!0},isLastMonth:{type:Boolean,required:!0}},emits:{"move-to-prev-month":null,"move-to-next-month":null},computed:{formattedDate(){const e=this.currentMonthDate.getFullYear(),s=ht.format(this.currentMonthDate);return`${s[0].toUpperCase()+s.slice(1)}, ${e}`}},methods:{moveToPrevMonth(){this.$emit("move-to-prev-month")},moveToNextMonth(){this.$emit("move-to-next-month")}}},_t={class:"calendarInfo"},ut={class:"text-medium"},mt={class:"calendarInfo__controls"},gt=["disabled"],Mt=["disabled"];function pt(e,s,o,a,n,t){const l=c("left-arrow-icon"),d=c("right-arrow-icon");return r(),h("div",_t,[i("h3",ut,g(t.formattedDate),1),i("div",mt,[i("button",{onClick:s[0]||(s[0]=(...m)=>t.moveToPrevMonth&&t.moveToPrevMonth(...m)),disabled:o.isFirstMonth,class:"calendarInfo__button","aria-label":"Move to Previous Month"},[_(l)],8,gt),i("button",{onClick:s[1]||(s[1]=(...m)=>t.moveToNextMonth&&t.moveToNextMonth(...m)),disabled:o.isLastMonth,class:"calendarInfo__button","aria-label":"Move to Next Month"},[_(d)],8,Mt)])])}const yt=u(dt,[["render",pt]]);const ft={props:{days:{type:Array,required:!0}},methods:{getDayClass(e){if(e===!0)return"calendarDays__item-success";if(e===!1)return"calendarDays__item-failure"}}},Dt={class:"calendarDays"},bt={class:"text-small"};function vt(e,s,o,a,n,t){return r(),h("ul",Dt,[(r(!0),h(b,null,T(o.days,(l,d)=>(r(),h("li",{key:d,class:$([t.getDayClass(l.is_done),"calendarDays__item"])},[i("span",bt,g(l.number),1)],2))),128))])}const xt=u(ft,[["render",vt]]);const y=42,Ct={components:{CalendarInfo:yt,CalendarDays:xt},props:{days:{type:Array,required:!0}},data(){const e=this.days?this.days[this.days.length-1].date:new Date;return{currentMonthDate:new Date(e.getFullYear(),e.getMonth(),1)}},computed:{beginDay(){return this.days[0]},lastDay(){return this.days[this.days.length-1]},isFirstMonth(){const e=this.currentMonthDate.getMonth(),s=this.currentMonthDate.getFullYear(),o=e===this.beginDay.date.getMonth(),a=s===this.beginDay.date.getFullYear();return o&&a},isLastMonth(){const e=this.currentMonthDate.getMonth(),s=this.currentMonthDate.getFullYear(),o=e===this.lastDay.date.getMonth(),a=s===this.lastDay.date.getFullYear();return o&&a},daysList(){const e=[],s=(6+this.currentMonthDate.getDay())%7;e[s]={number:1};const o=this.currentMonthDate.getFullYear(),a=this.currentMonthDate.getMonth(),n=new Date(o,a,1);for(let t=s+1;t<y;t++)n.setDate(n.getDate()+1),e[t]={number:n.getDate()};n.setDate(1),n.setMonth(n.getMonth()-1);for(let t=s-1;t>-1;t--)n.setDate(n.getDate()-1),e[t]={number:n.getDate()};return this.fillList(e)}},methods:{moveToPrevMonth(){const e=this.currentMonthDate.getMonth()-1;this.currentMonthDate.setMonth(e),this.currentMonthDate=new Date(this.currentMonthDate)},moveToNextMonth(){const e=this.currentMonthDate.getMonth()+1;this.currentMonthDate.setMonth(e),this.currentMonthDate=new Date(this.currentMonthDate)},fillList(e){const s=(6+this.currentMonthDate.getDay())%7;let o;if(this.isLastMonth){const a=this.lastDay.date.getDate();o=this.days.length-1;for(let n=s+a-1;n>=0;n--)this.days[o]&&(e[n].is_done=this.days[o].is_done,o=o-1)}else if(this.isFirstMonth){const a=this.beginDay.date.getDate();o=0;for(let n=s+a-1;n<y;n++)this.days[o]&&(e[n].is_done=this.days[o].is_done),o=o+1}else{o=this.days.findIndex(t=>{const l=t.date.getMonth()===this.currentMonthDate.getMonth(),d=t.date.getFullYear()===this.currentMonthDate.getFullYear();return l&&d&&t.date.getDate()===1});let a=o;for(let t=s;t<y;t++)this.days[a]&&(e[t].is_done=this.days[a].is_done),a=a+1;let n=o;for(let t=s-1;t>=0;t--)e[t].is_done=this.days[n].is_done,n=n-1}return e}}},kt={class:"calendar"},wt=L('<hr class="calendar__line"><ul class="calendar__weekNames"><li class="calendar__weekName text-small">\u043F\u043D</li><li class="calendar__weekName text-small">\u0432\u0442</li><li class="calendar__weekName text-small">\u0441\u0440</li><li class="calendar__weekName text-small">\u0447\u0442</li><li class="calendar__weekName text-small">\u043F\u0442</li><li class="calendar__weekName text-small">\u0441\u0431</li><li class="calendar__weekName text-small">\u0432\u0441</li></ul>',2);function Tt(e,s,o,a,n,t){const l=c("calendar-info"),d=c("calendar-days");return r(),h("div",kt,[_(l,{onMoveToPrevMonth:t.moveToPrevMonth,onMoveToNextMonth:t.moveToNextMonth,currentMonthDate:n.currentMonthDate,isFirstMonth:t.isFirstMonth,isLastMonth:t.isLastMonth},null,8,["onMoveToPrevMonth","onMoveToNextMonth","currentMonthDate","isFirstMonth","isLastMonth"]),wt,_(d,{days:t.daysList},null,8,["days"])])}const $t=u(Ct,[["render",Tt]]);const Lt={components:{AppHeader:I,HabitInfo:K,ChangingModal:tt,DeletingModal:st,HabitCalendar:$t},data(){return{habit:null,isChangingModalOpened:!1,isDeletingModalOpened:!1}},methods:{openChangingModal(){this.isChangingModalOpened=!0},closeChangingModal(){this.isChangingModalOpened=!1},changeHabitTitle(e){F(this.habit.id,e)},openDeletingModal(){this.isDeletingModalOpened=!0},closeDeletingModal(){this.isDeletingModalOpened=!1},deleteHabit(){B(this.habit.id),this.$router.push("/")}},created(){const s=+this.$route.params.id;N(s).then(o=>this.habit=o)}},It={key:0,class:"habit"},Ft={class:"habit__deleteButtonWrapper"},Bt={key:1,class:"message text-small"},Nt={key:2,class:"message"},Ht=i("h3",{class:"title"},"\u041F\u0440\u0438\u0432\u044B\u0447\u043A\u0430 \u043D\u0435 \u043D\u0430\u0439\u0434\u0435\u043D\u0430 :(",-1),Ot=O(" \u041F\u0435\u0440\u0435\u0439\u0442\u0438 \u043D\u0430 \u0433\u043B\u0430\u0432\u043D\u0443\u044E ");function Yt(e,s,o,a,n,t){const l=c("app-header"),d=c("habit-info"),m=c("habit-calendar"),v=c("router-link"),x=c("changing-modal"),C=c("deleting-modal");return r(),h(b,null,[_(l,{class:"app__header"}),n.habit?(r(),h("section",It,[_(d,{onOpenChangingModal:t.openChangingModal,habit:n.habit},null,8,["onOpenChangingModal","habit"]),_(m,{days:n.habit.days},null,8,["days"]),i("div",Ft,[i("button",{onClick:s[0]||(s[0]=(...k)=>t.openDeletingModal&&t.openDeletingModal(...k)),class:"habit__deleteButton text-small"}," \u0423\u0434\u0430\u043B\u0438\u0442\u044C \u043F\u0440\u0438\u0432\u044B\u0447\u043A\u0443 ")])])):n.habit===null?(r(),h("h3",Bt," \u041F\u0440\u0438\u0432\u044B\u0447\u043A\u0430 \u0433\u0440\u0443\u0437\u0438\u0442\u0441\u044F, \u043F\u043E\u0434\u043E\u0436\u0434\u0438\u0442\u0435 \u0441\u0435\u043A\u0443\u043D\u0434\u0443... ")):n.habit===void 0?(r(),h("div",Nt,[Ht,_(v,{to:"/",class:"habit__linkToHome text-small"},{default:H(()=>[Ot]),_:1})])):p("",!0),n.isChangingModalOpened?(r(),M(x,{key:3,onClose:t.closeChangingModal,onChangeTitle:t.changeHabitTitle,habitTitle:n.habit.title},null,8,["onClose","onChangeTitle","habitTitle"])):p("",!0),n.isDeletingModalOpened?(r(),M(C,{key:4,onClose:t.closeDeletingModal,onDeleteHabit:t.deleteHabit,habitTitle:n.habit.title},null,8,["onClose","onDeleteHabit","habitTitle"])):p("",!0)],64)}const Pt=u(Lt,[["render",Yt]]);export{Pt as default};
